# M-nback Web 版产品需求文档（PRD）

## 一、项目背景

N-back 是一种经典的工作记忆训练工具。用户需在持续呈现的刺激序列中判断当前刺激是否与 N 步之前的相同。M-nback 在此基础上通过加法题形式展现，旨在考察并提升用户的工作记忆能力、反应速度与注意力。

本项目为 M-nback 的 Web 实现版本，兼容桌面与移动端，侧重训练过程的数据统计与可视化分析。

---

## 二、产品目标

* 提供一个简洁、高效的 N-back 训练平台，支持多种难度与题量。
* 支持用户定制训练参数，快速进入训练流程。
* 自动记录每轮训练表现，支持导出历史记录。
* 提供时域统计图表，辅助用户理解训练成效。

---

## 三、核心玩法逻辑

### 3.1 题目生成

* 题目形式：两数相加（形如 A + B = ?）
* 限定条件：

  * A ∈ \[0, 9]，B ∈ \[1, 10 - A]
  * 答案落在 \[1, 10]
  * 排除 A = 1, B = 0 的组合

### 3.2 游戏机制

* N-back 模式，当前题需回忆第 N 题前的答案进行比对
* 初始 N 题为纯记忆积累期，无需作答
* 从第 N+1 题起，用户需点击按钮作答，判断是否与 N 步前答案相同
* 输入方式：按钮面板（两行五列，1\~10）

### 3.3 模式设置

* 模式类型：

  * 固定题量模式（12 题）
  * 无限练习模式（直到用户主动退出或累计答错 5 次）

* 开局前配置参数：

  * 用户名（文本框）
  * N 值（N1 \~ N9，下拉菜单）
  * 题量选择（12题 / 无限）

* 每次训练开始前显示前 N 题的题目与答案，提示用户记忆后开始训练

---

## 四、数据记录与评分机制

### 4.1 每局记录字段

```json
{
  "username": "string",
  "mode": "12题" | "无限",
  "N": number,
  "question_count": number,
  "correct_count": number,
  "total_time_sec": number,
  "accuracy": number,
  "score": number,
  "timestamp": ISODateTimeString,
  "exit_reason": "manual" | "mistake_limit" | null
}
```

### 4.2 分数计算

采用非线性综合评分机制：

```math
score = [100 * (c/t)^\u03b1 * (r)^\u03b2] * (1 + (N - 1)/5)
```

其中：

* $c$：答对题数
* $t$：总耗时（秒）
* $r$：正确率（0\~1）
* $\alpha = 0.8$、$\beta = 2$：调节参数
* $N$：当前关卡的 N 值

---

## 五、统计与可视化

### 5.1 个人统计页

分为两个视图：

* **12题模式报告**：每个 N 值下：

  * 总挑战次数
  * 综合成功率
  * 平均耗时（秒）

* **无限模式报告**：每个 N 值下：

  * 挑战次数
  * 最高作答题数
  * 综合正确率

### 5.2 时域变化曲线

* X 轴：训练时间戳
* Y 轴（多条曲线）：

  * 准确率
  * 平均耗时
  * 最终分数

### 5.3 首错概率分析

记录并展示“首次出错”出现的位置分布（题号 1\~12）

* 每个 N 值生成一个数组：

```json
{
  "N2": [0,3,7,2,0,0,0,0,0,0,0,1,2] // 最后一项为未出错次数
}
```

---

## 六、数据管理

### 6.1 本地存储

* 历史记录通过浏览器 LocalStorage 保存
* 所有数据支持通过 JSON 格式导出

### 6.2 导出格式

```json
{
  "user": "\u5c0f\u6728",
  "records": [ {...}, {...} ],
  "first_error_profile": { ... }
}
```

---

## 七、界面设计要点

### 7.1 响应式布局

* 桌面端与移动端均需适配
* 输入按钮居中，固定两行五列布局（1\~10）
* 时间、题号、当前题目清晰展示

### 7.2 状态引导

* 开局：配置页
* 准备阶段：展示前 N 题
* 作答阶段：一题一题展示 + 输入 + 答案反馈（正确/错误）
* 局后报告：成绩摘要 + 曲线图跳转按钮

---

## 八、开发建议

### 8.1 技术栈

* 前端：Vite+Vue +daisyUI
* 状态管理：Pinia / Zustand
* 图表：ECharts / Chart.js
* 数据导出：Blob + JSON.stringify

### 8.2 结构规划

* `config/`：默认参数定义
* `components/`：题目展示、按钮面板、统计图表
* `stores/`：训练状态、历史数据
* `utils/`：分数计算器、首错分布生成器

---

## 九、未来可扩展方向

* 增加题型（减法、乘法、带括号表达式）
* 添加排行榜与社交分享功能
* 云端账号同步与存档

---

**最终目标：** 构建一个逻辑严谨、反馈清晰、可持续使用的工作记忆训练平台，帮助用户以可视化的方式感知自身变化并建立自我激励机制。
